<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.gaokao360.dao.ex.IGkPsychologyDAO">
    <!--
    insert
    update
    updateNull
    deleteById
    deleteByCondition
    deleteByProperty
    fetch
    findOne
    findList
    findAll
    queryPage
    like
    queryList
    queryOne
    count
    selectMaxId
    updateOrSave
    selectOne
    selectList
    -->

    <sql id="Base_Column_List">
        course.id as id ,
        course.classifyId as classifyId ,
        course.teacherId as teacherId ,
        course.subjectId as subjectId ,
        course.managerId as managerId ,
        course.teacher as teacher ,
        course.title as title ,
        course.content as content ,
        course.frontCover as frontCover ,
        course.subcontent as subcontent ,
        course.hit as hit ,
        course.years as years ,
        course.beikaochongci_type as beikaochongciType ,
        course.courseSort as courseSort ,
        course.frontcover1 as frontcover1 ,
        course.isAccept as isAccept ,
        course.createDate as createDate ,
        course.status as status ,
        course.lastModDate as lastModDate ,
        course.areaId as areaId ,
        course.creator as creator ,
        course.lastModifier as lastModifier,
        classify.classifyName as  classifyName,
        gksubject.id as subjectName,
        province.name as province

    </sql>

    <select id="queryPage" resultType="VideoCourse">
        SELECT
        <include refid="Base_Column_List" />
        FROM gk_video_course course
        LEFT OUTER JOIN gk_video_classify classify ON classify.id = course.classifyId
        LEFT OUTER JOIN gk_subject gksubject ON course.subjectId = gksubject.subjectName
        LEFT JOIN gk_province province ON course.areaId = province.id

        <where>
            course.classifyId=2
            <if test="condition.whereSql != null">
                and id in (#{condition.whereSql})
            </if>
            <if test="condition.coursesubjectId!=null">
                ${condition.groupOp}   ${condition.course.subjectId.field}  ${condition.course.subjectId.op}  #{condition.course.subjectId.data}
            </if>
            <if test="condition.courseareaId!=null">
                ${condition.groupOp}   ${condition.course.areaId.field}  ${condition.course.areaId.op}  #{condition.course.areaId.data}
            </if>
            <if test="condition.queryparam!=null">
                and (course.teacher like CONCAT('%', #{condition.queryparam.data} , '%')  OR course.subcontent like CONCAT('%', #{condition.queryparam.data} , '%')')
            </if>


        </where>
        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
        <if test="offset != null">
            limit ${offset}, ${rows}
        </if>
    </select>


    <select id="count" resultType="java.lang.Integer">
        SELECT count(course.id) FROM gk_video_course course
        LEFT OUTER JOIN gk_video_classify classify ON classify.id = course.classifyId
        LEFT OUTER JOIN gk_subject gksubject ON course.subjectId = gksubject.subjectName
        LEFT JOIN gk_province province ON course.areaId = province.id
        <where>
            course.classifyId=2
            <if test="coursesubjectId!=null">
                ${groupOp}   ${course.subjectId.field}  ${course.subjectId.op}  #{course.subjectId.data}
            </if>
            <if test="courseareaId!=null">
                ${groupOp}   ${course.areaId.field}  ${course.areaId.op}  #{course.areaId.data}
            </if>
            <if test="queryparam!=null">
                and (course.teacher like CONCAT('%', #{queryparam.data} , '%')  OR course.subcontent like CONCAT('%', #{queryparam.data} , '%')')
            </if>
        </where>
    </select>

</mapper>

