<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.zgk.dao.ex.IUniversityMajoredDAO">
    <!--
    insert
    update
    updateNull
    deleteById
    deleteByCondition
    deleteByProperty
    fetch
    findOne
    findList
    findAll
    queryPage
    like
    queryList
    queryOne
    count
    selectMaxId
    updateOrSave
    selectOne
    selectList
    -->

    <sql id="Base_Column_List">
        majored.id as id,
        majored.name as name,
        majored.majoredType as majoredType,
        majored.degree as degree,
        plan.schoolLength as schoolLength,
        plan.feeStandard as feeStandard,
        plan.universityId as universityId,
        plan.universityName as universityName,
        report.batch1 as batch
    </sql>
    <select id="queryPage" resultType="cn.thinkjoy.zgk.dto.UniversityMajoredDTO">
        SELECT
        <include refid="Base_Column_List"/>
        from zgk_majored majored
        left join zgk_enroll_plan plan on majored.id=plan.majoredId
        left join zgk_enroll_report report on report.universityCode=plan.universityCode
        WHERE 1=1
        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
        <if test="offset != null">
            limit ${offset}, ${rows}
        </if>
    </select>


    <select id="count" resultType="java.lang.Integer">
        SELECT count(majored.id)
        from zgk_majored majored
        left join zgk_enroll_plan plan on majored.id=plan.majoredId
        left outer join zgk_enroll_report report on report.universityCode=plan.universityCode
        <where>
            <if test="scheduleareaId!=null">
                ${groupOp} ${scheduleareaId.field} ${scheduleareaId.op} #{scheduleareaId.data}
            </if>
            <if test="queryparam!=null">
                ${groupOp} (province.name like #{queryparam.data} OR schedule.month like #{queryparam.data} OR
                schedule.years like #{queryparam.data})
            </if>
        </where>
    </select>

</mapper>

